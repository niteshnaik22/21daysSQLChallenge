SELECT
  CASE
    WHEN event IS NOT NULL AND event = "Flu" "Donation" "Strike" THEN 'With Event'
    ELSE 'No Event'
  END AS event_status,
  COUNT(*) AS weeks_count,
  AVG(NULLIF(patient_satisfaction, 0) ) FILTER (WHERE patient_satisfaction IS NOT NULL) AS avg_patient_satisfaction,
  AVG(Patient_sATISFACTION) 
  aVG(sTAFF_MORALE)
FROM services_weekly
GROUP BY event_status
ORDER BY AVG(Patient_sATISFACTION) DESC;
