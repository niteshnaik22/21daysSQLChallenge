-- Day 9
-- Extract the year from all patient arrival dates.
SELECT name, YEAR(Arrival_Date) AS ArrivalYear FROM Patients;

-- Calculate the length of stay for each patient (departure_date - arrival_date).
SELECT name, Arrival_Date, Departure_Date, DATEDIFF(Departure_Date, Arrival_Date) AS LengthOfStay FROM Patients;

-- Find all patients who arrived in a specific month.
SELECT name, Arrival_Date FROM Patients WHERE MONTH(Arrival_Date) = 7;

-- Daily Challenge
-- (Calculate the average length of stay (in days) for each service, showing only services where the average stay is more than 7 days.
Also show the count of patients and order by average stay descending.)

SELECT 
  Service,
  COUNT(*) AS PatientCount,
  ROUND(AVG(DATEDIFF(Departure_Date, Arrival_Date)), 2) AS Avg_Stay
FROM Patients
GROUP BY Service
HAVING Avg_Stay > 7
ORDER BY Avg_Stay DESC;
